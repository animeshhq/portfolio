---
import { getCollection } from 'astro:content';
import Nav from '../../components/Nav.tsx';
import Layout from '../../layouts/Layout.astro';
import '@fontsource/vt323';
import '@fontsource-variable/outfit';

// Define the possible group names
type GroupName = 'Tech' | 'Design' | 'Entrepreneurship';

// Fetch all newsletters
const posts = await getCollection('newsletter');

// Group newsletters by the 'group' field
const groups: Record<GroupName, typeof posts> = posts.reduce((acc, post) => {
  const groupName = post.data.group as GroupName;
  if (!acc[groupName]) {
    acc[groupName] = [];
  }
  acc[groupName].push(post);
  return acc;
}, {} as Record<GroupName, typeof posts>);

// Group cover images (manually set)
const groupImages: Record<GroupName, string> = {
  "Tech": "/images/tech.png",
  "Design": "/images/tech.png",
  "Entrepreneurship": "/images/tech.png",
};
---

<Layout title="Newsletter Groups">
  <header>
    <Nav client:load />
  </header>
  <main class="min-h-screen w-full bg-black text-white flex flex-col items-center py-20">
    <div class="container mx-auto px-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {Object.keys(groups).map((groupName, index) => (
        <a 
          href={`/group/${groupName.toLowerCase().replace(/\s+/g, '-')}/`} 
          class={`group block rounded-lg overflow-hidden ${index !== Object.keys(groups).length - 1 ? 'border-b border-gray-600 sm:border-0' : ''}`}
        >
          <img 
            src={groupImages[groupName as GroupName]} 
            alt={`${groupName} group`} 
            class="w-full max-h-60 object-contain transition-transform duration-300 ease-in-out group-hover:scale-105" 
          />
          <div class="bg-black p-3">
            <h2 class="text-xl md:text-xl text-white text-center font-outfit">{groupName}</h2>
          </div>
        </a>
      ))}
    </div>
  </main>
</Layout>
